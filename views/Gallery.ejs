<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Gallery</title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css" rel="stylesheet"/>
    <link rel="stylesheet" href="/stylesheet/Gallery.css">
    <link rel="stylesheet" href="/stylesheet/navbaar.css">
    <link rel="stylesheet" href="/stylesheet/Student.css">
    <link rel="stylesheet" href="/stylesheet/preloader.css">

</head>
<body>

    <%- include('partials/preloader') %>


    <div class="navSlide">
        <div class="icon">
         <i class="ri-close-large-line"></i>
        </div>
         <ul class="NavLinks">
           <li><a href="/">Home</a></li>
           <li><a href="/members">Members</a></li>
           <li><a href="/clubs">Clubs</a></li>
           <li><a href="/faculty">Mentors</a></li>
           <li><a href="/gallery">Event Gallary</a></li>
           <li><a href="/login" class="loginButton">Login</a></li>   
       </ul>
       </div>

    <nav>
        <div class="logo">
            <img class="image-logo" src="/image folder/Student council png.png"/ title="council logo">
            <h1>STUDENT COUNCIL</h1>
        </div>
        <ul class="nav-links">
            <li><a href="/">Home</a></li>
            <li><a href="/members">Members</a></li>
            <li><a href="/clubs">Clubs</a></li>
            <li><a href="/faculty">Mentors</a></li>
            <li><a href="/gallery">Event Gallary</a></li>
            <i class="ri-menu-line"></i>
        </ul>
    </nav>

<div class="container">
    
<div class="box"><h1>STUDENT COUNCIL<br/><span>Event Gallery</span></h1></div>
    <div class="gallery" id="gallery"></div>

    <div class="popup" id="popup">
        <div class="popup-content">
            <img id="popup-img" src="" alt="Enlarged Image">
            <div class="popup-controls">
                <button class="popup-btn download-btn" title="Download Image">
                    <span class="btn-icon"><i class="ri-download-line"></i></span>
                    <span class="btn-tooltip">Download</span>
                </button>
                <button class="popup-btn share-btn" title="Share Image">
                    <span class="btn-icon"><i class="ri-share-line"></i></span>
                    <span class="btn-tooltip">Share</span>
                </button>
            </div>
            <button class="close-btn" id="close-btn">
                <i class="ri-close-line"></i>
            </button>
        </div>
    </div>

    <div id="toast" class="toast"></div>
</div>
    <footer>
        <a href="/Dev">
            <button class="button">Developer team</button>      
        </a>
    </footer>

    <script src="/javascript/preloader.js"></script>    

    <script src="/javascript/navbaar.js"></script>

    <script>
        const images = [
            {img: "/image folder/Event Photos/IMG-20241110-WA0049.jpg"},
            {img: "/image folder/Event Photos/IMG_20240214_130059684.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0031.jpg"},
            {img: "/image folder/Event Photos/46.png"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0009.jpg"},
            {img: "/image folder/Event Photos/10.png"},
            {img: "/image folder/Event Photos/58.png"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0038.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0045.jpg"},
            {img: "/image folder/Event Photos/60.png"},
            {img: "/image folder/Event Photos/4.png"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0041.jpg"},
            {img: "/image folder/Event Photos/38.png"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0052.jpg"},
            {img: "/image folder/Event Photos/19.png"},
            {img: "/image folder/Event Photos/5.png"},
            {img: "/image folder/Event Photos/52.png"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0011.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0025.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0028.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0007.jpg"},
            {img: "/image folder/Event Photos/49.png"},
            {img: "/image folder/Event Photos/25.png"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0012.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0022.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0018.jpg"},
            {img: "/image folder/Event Photos/40.png"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0046.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0014.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0054.jpg"},
            {img: "/image folder/Event Photos/24.png"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0051.jpg"},
            {img: "/image folder/Event Photos/15.png"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0030.jpg"},
            {img: "/image folder/Event Photos/IMG_20240214_122157876.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0050.jpg"},
            {img: "/image folder/Event Photos/18.png"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0024.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0034.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0047.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0037.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0032.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0008.jpg"},
            {img: "/image folder/Event Photos/66.png"},
            {img: "/image folder/Event Photos/13.png"},
            {img: "/image folder/Event Photos/68.png"},
            {img: "/image folder/Event Photos/8.png"},
            {img: "/image folder/Event Photos/51.png"},
            {img: "/image folder/Event Photos/12.png"},
            {img: "/image folder/Event Photos/64.png"},
            {img: "/image folder/Event Photos/34.png"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0019.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0053.jpg"},
            {img: "/image folder/Event Photos/IMG-20241110-WA0026.jpg"},
            
        ];

        const gallery = document.getElementById("gallery");
        const popup = document.getElementById("popup");
        const popupImg = document.getElementById("popup-img");
        let currentImageIndex = 0;

        // Create gallery images with enhanced structure
        function createGallery() {
            images.forEach((item, index) => {
                const imgContainer = document.createElement("div");
                imgContainer.className = "gallery-item";
                
                const img = document.createElement("img");
                img.src = item.img;
                img.alt = `Gallery Image ${index + 1}`;
                
                img.addEventListener("click", () => {
                    openPopup(item.img, index);
                });
                
                imgContainer.appendChild(img);
                gallery.appendChild(imgContainer);
            });
        }

        // Popup functionality
        function openPopup(imgSrc, index) {
            popup.style.display = "flex";
            popupImg.src = imgSrc;
            currentImageIndex = index;
            document.body.style.overflow = 'hidden';
        }

        function closePopup() {
            popup.style.display = "none";
            document.body.style.overflow = '';
        }

        // Update the toast notification function
        function showToast(message) {
            const toast = document.getElementById('toast');
            let icon = 'ri-check-line';
            
            // Set appropriate icon based on message
            if (message.includes('error') || message.includes('failed')) {
                icon = 'ri-error-warning-line';
            } else if (message.includes('copied')) {
                icon = 'ri-file-copy-line';
            }
            
            toast.innerHTML = `
                <i class="${icon}"></i>
                <span>${message}</span>
            `;
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Update download function with loading state
        async function downloadImage(imgSrc) {
            const downloadBtn = document.querySelector('.download-btn');
            try {
                downloadBtn.innerHTML = '<span class="btn-icon"><i class="ri-loader-4-line"></i></span>';
                downloadBtn.style.pointerEvents = 'none';
                
                const response = await fetch(imgSrc);
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = imgSrc.split('/').pop();
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                showToast('Image downloaded successfully!');
            } catch (error) {
                showToast('Failed to download image');
            } finally {
                downloadBtn.innerHTML = `
                    <span class="btn-icon"><i class="ri-download-line"></i></span>
                    <span class="btn-tooltip">Download</span>
                `;
                downloadBtn.style.pointerEvents = 'auto';
            }
        }

        // Share functionality
        async function shareImage(imgSrc) {
            try {
                if (navigator.share) {
                    await navigator.share({
                        title: 'Gallery Image',
                        text: 'Check out this image from our gallery!',
                        url: window.location.origin + imgSrc
                    });
                } else {
                    await navigator.clipboard.writeText(window.location.origin + imgSrc);
                    showToast('Image URL copied to clipboard!');
                }
            } catch (error) {
                showToast('Unable to share image');
            }
        }

        // Event listeners
        document.getElementById("close-btn").addEventListener("click", closePopup);

        popup.addEventListener("click", (e) => {
            if (e.target === popup) {
                closePopup();
            }
        });

        // Add event listeners for download and share buttons
        document.querySelector('.download-btn').addEventListener('click', () => {
            downloadImage(popupImg.src);
        });

        document.querySelector('.share-btn').addEventListener('click', () => {
            shareImage(popupImg.src);
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (!popup.style.display || popup.style.display === 'none') return;

            switch(e.key) {
                case 'Escape':
                    closePopup();
                    break;
                case 'ArrowLeft':
                    navigateImage(-1);
                    break;
                case 'ArrowRight':
                    navigateImage(1);
                    break;
            }
        });

        // Image navigation
        function navigateImage(direction) {
            currentImageIndex = (currentImageIndex + direction + images.length) % images.length;
            popupImg.src = images[currentImageIndex].img;
        }

        // Initialize gallery
        createGallery();
    </script>
</body>
</html>